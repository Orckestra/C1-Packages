<?xml version="1.0" standalone="yes"?>
<mi:PackageInstaller xmlns:mi="http://www.composite.net/ns/management/packageinstaller/1.0">
	<mi:PackageRequirements minimumCompositeVersion="6.7.0000.0000" maximumCompositeVersion="9.9999.9999.9999" />
	<mi:PackageInformation 
    name="Orckestra.Web.Typescript" 
    groupName="Orckestra.Web" 
    version="1.0.0"
    author="Orckestra A/S" 
    website="https://c1.orckestra.com/" 
    readMoreUrl="https://docs.c1.orckestra.com/" 
    id="7d27b88a-f79e-4ec1-919a-24ffbd457384" 
    canBeUninstalled="true" 
    systemLocking="hard" 
    flushOnCompletion="true" 
    reloadConsoleOnCompletion="false">
		<TechnicalDetails>
	Package provides typescripts compilation into javascript using Microsoft Typescript Compiler of version 3.1.5.
Any typescripts changes will be dynamically recompiled into a javascript file. Typescripts changes can critically 
influence on alive web site, therefore pretty recommended to provide any tests, changes or configurations both with 
this package and with your typescripts in test enviroment, not on alive web site.

	Before installation be sure you have turned off debug mode of your web site. To check debug mode status of your 
web site open Web.config in the root of you site and locate to the configuration/system.web/compilation path to 
debug attribute.
    </TechnicalDetails>
		<Description>
	Package is preconfigured to be ready to compile Typescripts of default Orckestra RefApplication application on 
C1 engine. By default, typescripts will be looking in the folder ~/UI.Package/Typescript and will be compiled into 
a file ~/UI.Package/Javascript/orckestra.composer.js. But you can change this behavior and any other settings.

Package has 3 level of settings:
- General settings;
- Package settings;
- Compilation settings.

Lev.1. General settings. Located in the root in Web.config of your site and allows you to turn on or to turn off this 
package. If you don't use this package, recommended to turn it off. To turn on or to turn off this package open 
Web.config in the root of your site, locate to configuration/appSettings and find a key "Orckestra.Web.Typescripb.Enable". 
Here you can set up "true" or "false" value depending what you need. Also notice, that any errors of this package will be 
thrown if you set up debug mode in Web.config. To check or to set up debug mode open a Web.config file and locate to 
configuration/system.web/compilation path. Set up "true" or "false" depending what do you need.

Lev.2. Package (assembly) settings. Located in Bin folder of your site and allows you to change this package settings and 
to create typescript compilation tasks. To manage your package settings, open Bin folder and locate to the 
Orckestra.Web.Typescript.dll.cmp.xml file. Explanation about purpose of every setting you can find in this file in comments. 
Every typescript task amoung other settings contains a path to a compilation settings file tsconfig.json. 
This file is originally used by Microsoft Typescript Compiler for typescripts compilation.

Lev.3. Compilation (tsconfig.json) settings. Originally this file is used by TypescriptCompiler for compilation. 
The path to the tsconfig.json file is configuring in tasks in package settings (lev.2). Predefinied tsconfig.json file has 
minimun settings, but you can specify any other compilation settings. The only restriction, you must set up outFile value in
tsconfig.json. More about tsconfig.json project file and possible attributes and options you can read at 
https://www.typescriptlang.org/docs/handbook/tsconfig-json.html
    </Description>
	</mi:PackageInformation>
  <mi:PackageFragmentInstallers>
    <mi:Add installerType="Composite.Core.PackageSystem.PackageFragmentInstallers.FilePackageFragmentInstaller, Composite" 
            uninstallerType="Composite.Core.PackageSystem.PackageFragmentInstallers.FilePackageFragmentUninstaller, Composite">
      <Files>
        <File sourceFilename="~\Bin\Orckestra.Web.Typescript.dll" targetFilename="~\Bin\Orckestra.Web.Typescript.dll" allowOverwrite="true" />
        <File sourceFilename="~\Bin\Orckestra.Web.Typescript.dll.cmp.xml" targetFilename="~\Bin\Orckestra.Web.Typescript.dll.cmp.xml" allowOverwrite="true" />
        <File sourceFilename="~\Bin\Orckestra.Web.Typescript.dll.cmp.xsd" targetFilename="~\Bin\Orckestra.Web.Typescript.dll.cmp.xsd" allowOverwrite="true" />
        <File sourceFilename="~\tsconfig.json" targetFilename="~\tsconfig.json" allowOverwrite="false" />
      </Files>
      <Directories>
        <Directory sourceDirectory="~\Bin\TypescriptCompiler\" targetDirectory="~\Bin\TypescriptCompiler\" allowOverwrite="true" deleteTargetDirectory="false"/>
      </Directories>
    </mi:Add>
    <mi:Add 
      installerType="Composite.Core.PackageSystem.PackageFragmentInstallers.DllPackageFragmentInstaller, Composite" 
      uninstallerType="Composite.Core.PackageSystem.PackageFragmentInstallers.DllPackageFragmentUninstaller, Composite">
      <Files>
        <File sourceFilename="~\Bin\NUglify.dll" targetFilename="~\Bin\NUglify.dll" allowOverwrite="true" addAssemblyBinding="true"/>
      </Files>
    </mi:Add>
    <mi:Add
  installerType="Composite.Core.PackageSystem.PackageFragmentInstallers.FileXslTransformationPackageFragmentInstaller, Composite"
  uninstallerType="Composite.Core.PackageSystem.PackageFragmentInstallers.FileXslTransformationPackageFragmentUninstaller, Composite">
      <XslFiles>
        <XslFile pathXml="~/Web.config" installXsl="~\Web.config\Install.xsl" uninstallXsl="~\Web.config\Uninstall.xsl" />
      </XslFiles>
    </mi:Add>
  </mi:PackageFragmentInstallers>
</mi:PackageInstaller>